'use strict';
angular.module('myApp.list', ['ngRoute', 'templates'])

.config(['$routeProvider', function($routeProvider) {
  $routeProvider.when('/lists/:id/tasks', {
    templateUrl: '<%= asset_path("list.html") %>',
    controller: 'ListCtrl',
    resolve: {
      jsonGrab: ['$http', '$route', function($http, $route) {
        return $http.get('/api/lists/' + $route.current.params.id + '/tasks').then(function(response) {
          return response.data;
        });
      }],
    }
  });
}])

.controller('ListCtrl', ['$scope', 'jsonGrab', '$http', function($scope, jsonGrab, $http) {
  $scope.taskJson = jsonGrab.tasks;
  $scope.listJson = jsonGrab.list;
  $scope.echo = function(list, task){
    $http.delete('/api/lists/' + list.id + '/tasks/' + task.id)
    // return $http.delete('/api/lists/' + $route.current.params.id + '/tasks').then(function(response) {
    //   return response.data;
    // }
  }
}]);